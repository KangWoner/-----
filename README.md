# AI 기반 Google Form 자동 채점 및 피드백 스크립트

Google Form으로 제출된 과제를 OpenAI API를 이용해 자동으로 채점하고, 그 결과를 Google Sheets에 기록한 뒤 학생에게 이메일로 피드백을 보내주는 Google Apps Script 프로토타입입니다.

## 주요 기능

- **자동 채점**: Google Form 응답이 제출되면, 연결된 시트의 마지막 행을 읽어 AI가 채점합니다.
- **상세 루브릭 적용**: 개념, 논리, 계산, 표현 네 가지 항목으로 구성된 루브릭을 기반으로 채점합니다.
- **결과 기록**: 총점, 항목별 점수, 텍스트 피드백을 시트의 해당 행에 자동으로 추가합니다.
- **이메일 알림**: 채점이 완료되면 학생의 이메일로 피드백 요약과 결과 시트 링크를 발송합니다.

---

## 사전 준비 사항

1.  **Google 계정**: Google Forms, Google Sheets, Gmail 사용을 위해 필요합니다.
2.  **OpenAI API 키**: OpenAI 또는 호환 API 제공업체로부터 발급받은 API 키가 필요합니다.
    - [OpenAI API 키 발급 페이지](https://platform.openai.com/api-keys)

---

## 설치 및 설정 방법

아래 단계를 순서대로 따라오세요.

### 1단계: Google Form 및 Sheet 생성

1.  **Google Form 생성**:
    - [Google Forms](https://forms.google.com/u/0/)로 이동하여 새 양식을 만듭니다.
    - 아래 항목들이 포함된 질문을 추가합니다. (질문 유형은 모두 '단답형' 또는 '장문형'으로 설정)
      - `이름`
      - `이메일` (이메일 주소 형식 확인 기능 사용 권장)
      - `내가 푼 문제`
      - `나의 풀이`
      - `파일(URL 가능)` (선택 사항)

2.  **Google Sheet 연결**:
    - Form 편집기 상단의 **'응답'** 탭으로 이동합니다.
    - 오른쪽 위에 있는 **'스프레드시트 아이콘 (링크)'**을 클릭합니다.
    - **'새 스프레드시트 만들기'**를 선택하여 응답 시트를 생성합니다.
    - 생성된 시트가 새 탭에서 열립니다. F, G, H 열에 각각 `총점`, `항목별 점수`, `피드백` 헤더를 미리 추가해두면 좋습니다.

### 2단계: Apps Script 코드 붙여넣기

1.  **Apps Script 편집기 열기**:
    - 응답을 받고 있는 Google Sheet에서 상단 메뉴의 **'확장 프로그램' > 'Apps Script'**를 클릭합니다.

2.  **`Code.gs` 파일 내용 붙여넣기**:
    - Apps Script 편집기에 기본으로 생성된 `Code.gs` 파일의 모든 내용을 삭제합니다.
    - `/appsScript/Code.gs` 파일에 있는 코드를 전체 복사하여 `Code.gs` 편집기 창에 붙여넣습니다.

3.  **`appsscript.json` 파일 내용 수정**:
    - 편집기 왼쪽 메뉴에서 **'프로젝트 설정' (톱니바퀴 아이콘)** 아래에 있는 **'편집기' > `"appsscript.json" 매니페스트 파일 표시`** 체크박스를 활성화합니다.
    - 왼쪽 메뉴에 나타난 `appsscript.json` 파일을 클릭합니다.
    - 파일의 모든 내용을 삭제하고, 이 프로젝트의 `/appsScript/appsscript.json` 파일에 있는 코드를 전체 복사하여 붙여넣습니다.
    - **파일 > 프로젝트 저장 (디스크 아이콘)**을 눌러 두 파일의 변경사항을 모두 저장합니다.

### 3단계: OpenAI API 키 등록

1.  **스크립트 속성 메뉴 열기**:
    - Apps Script 편집기 왼쪽 메뉴에서 **'프로젝트 설정' (톱니바퀴 아이콘)**을 클릭합니다.

2.  **API 키 추가**:
    - 페이지 중간에 있는 **'스크립트 속성'** 섹션에서 **'스크립트 속성 추가'** 버튼을 클릭합니다.
    - **'속성'** 필드에는 `OPENAI_API_KEY`를 입력합니다. (대소문자 정확히 일치해야 함)
    - **'값'** 필드에는 사전 준비 단계에서 발급받은 본인의 OpenAI API 키를 붙여넣습니다. (`sk-...`로 시작하는 키)
    - **'스크립트 속성 저장'**을 클릭하여 저장합니다.

### 4단계: 트리거 설정

1.  **트리거 메뉴 열기**:
    - Apps Script 편집기 왼쪽 메뉴에서 **'트리거' (시계 아이콘)**를 클릭합니다.

2.  **새 트리거 추가**:
    - 오른쪽 하단의 **'+ 트리거 추가'** 버튼을 클릭합니다.
    - 아래와 같이 트리거를 설정합니다.
      - **실행할 함수 선택**: `onFormSubmit`
      - **실행 배포 선택**: `Head`
      - **이벤트 소스 선택**: `스프레드시트에서`
      - **이벤트 유형 선택**: `양식 제출 시`
    - **'저장'** 버튼을 클릭합니다.

3.  **권한 승인**:
    - 트리거를 저장하면 Google 계정으로 권한을 승인하라는 창이 나타납니다.
    - 본인의 계정을 선택하고, "이 앱은 Google에서 확인하지 않았습니다"라는 경고가 표시되면 **'고급'**을 클릭한 뒤 **'(안전하지 않음) 프로젝트 이름(으)로 이동'**을 선택하여 권한을 허용합니다.
    - 이 스크립트가 Sheets, Gmail, 외부 API 호출 등을 수행하기 위해 필요한 절차입니다.

---

## 테스트 절차

1.  **양식 제출**:
    - 설정 과정에서 만든 Google Form을 열어 테스트용 데이터를 입력하고 제출합니다.
    - '이메일' 항목에는 실제로 피드백을 수신할 수 있는 본인의 이메일 주소를 입력합니다.

2.  **결과 확인**:
    - **Google Sheet 확인**: 응답 시트에 새로운 행이 추가되고, 약 10-30초 후 `총점`, `항목별 점수`, `피드백` 열이 자동으로 채워지는지 확인합니다.
    - **이메일 확인**: 양식에 입력한 이메일 주소의 수신함을 확인하여 피드백 요약 이메일이 도착했는지 확인합니다.

3.  **실행 로그 확인 (오류 발생 시)**:
    - 만약 결과가 제대로 표시되지 않으면 Apps Script 편집기 왼쪽 메뉴의 **'실행'** 탭에서 `onFormSubmit` 함수의 실행 기록을 확인합니다.
    - '상태'가 '실패'인 경우 로그를 통해 오류의 원인을 파악할 수 있습니다. (예: API 키 오류, 할당량 초과 등)
